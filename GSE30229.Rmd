---
title: "GSE30229"
authors:
- name: Edgaras Legus
- name: Vitalija Misiukonytė
- name: Brigita Ižganaitytė
- name: Gabrielė Dilytė
- name: Dalia Masilionytė
- name: Reda Vaisėtaitė
- name: Paulius Matijošaitis
- name: Dovilė Patiejūnaitė
date: '2018 m. kovas 6 d.'
output: html_document
---
Downloading the data using GEO 
```{r, include=TRUE, echo=TRUE}
library(GEOquery)
GSE30229 <- getGEO("GSE30229", destdir = "./")
```

Obtaining the matrix of beta values where each row corresponds to probes (names) and each column corresponds to samples

```{r, include=TRUE, echo=TRUE}
matrix <- exprs(GSE30229[[1]])
head(rownames(matrix))
head(colnames(matrix))
```

Counting samples and probes in our data
```{r, include=TRUE, echo=TRUE}
samples <- colnames(matrix)
probes <- rownames(matrix)
length(samples)
length(probes)
```

Distribution of beta values
```{r, include=TRUE, echo=TRUE}
hist(matrix, breaks=1000, xlab = "Beta Value ", border = "green", main = "Beta value distribution")
```

Names of probes
```{r, include=TRUE, echo=TRUE}
head(rownames(matrix))
```

Annotation that tells the coordinate (in hg19) of each probe and its genomic features
```{r, include=TRUE, echo=TRUE}
annotate <- getGEO("GPL8490", destdir = "./")
annotate <- Table(annotate)

annotated_probes <- intersect(annotate$ID, rownames(matrix))
cat("Probes number: ", length(annotated_probes), "\n")

i <- match(annotated_probes, annotate$ID)
annotate <- annotate[i, ]

i <- match(annotated_probes, rownames(matrix))
matrix <- matrix[i,]
stopifnot(all(rownames(matrix) == annotate$ID))

head(annotate)
```

Samples which correspond to healthy individuals, and which samples correspond to the sick ones
```{r, include=TRUE, echo=TRUE}
sickness <- pData(phenoData(GSE30229[[1]]))
sickness[1:20,1]
```

